import { isSameDay, getWeeksInMonth } from '@internationalized/date';
import { getStartOfWeek } from './get-start-of-week.mjs';

function getDaysInWeek(weekIndex, from, locale, firstDayOfWeek) {
  const weekDate = from.add({ weeks: weekIndex });
  const dates = [];
  let date = getStartOfWeek(weekDate, locale, firstDayOfWeek);
  while (dates.length < 7) {
    dates.push(date);
    let nextDate = date.add({ days: 1 });
    if (isSameDay(date, nextDate)) {
      break;
    }
    date = nextDate;
  }
  return dates;
}
function getMonthDays(from, locale, numOfWeeks, firstDayOfWeek) {
  const monthWeeks = getWeeksInMonth(from, locale);
  const weeks = [...new Array(numOfWeeks ?? monthWeeks).keys()];
  return weeks.map((week) => getDaysInWeek(week, from, locale, firstDayOfWeek));
}

export { getDaysInWeek, getMonthDays };
