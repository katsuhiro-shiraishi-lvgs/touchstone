'use strict';

Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });

const ReactExports = require('react');
const reactDom = require('react-dom');
const useLayoutEffect = require('./use-layout-effect.js');

function Portal(props) {
  const { children, target } = props;
  const node = ReactExports.useRef(null);
  const portalNode = ReactExports.useRef(null);
  const [, forceUpdate] = ReactExports.useReducer((s) => s + 1, 0);
  useLayoutEffect.useSafeLayoutEffect(() => {
    if (!node.current)
      return;
    const doc = node.current.ownerDocument;
    portalNode.current = doc.createElement("zag-portal");
    doc.body.appendChild(portalNode.current);
    forceUpdate();
    return () => {
      if (portalNode.current) {
        doc.body.removeChild(portalNode.current);
      }
    };
  }, []);
  const targetNode = target?.current ?? portalNode.current;
  if (targetNode) {
    return reactDom.createPortal(children, targetNode);
  }
  return ReactExports.createElement("span", { ref: node });
}

exports.Portal = Portal;
