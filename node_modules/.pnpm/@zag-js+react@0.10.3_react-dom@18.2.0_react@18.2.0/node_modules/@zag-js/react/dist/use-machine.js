'use strict';

Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });

const useConstant = require('./use-constant.js');
const useLayoutEffect = require('./use-layout-effect.js');
const useSnapshot = require('./use-snapshot.js');

function useService(machine, options) {
  const { actions, state: hydratedState, context } = options ?? {};
  const service = useConstant.useConstant(() => {
    const instance = typeof machine === "function" ? machine() : machine;
    return context ? instance.withContext(context) : instance;
  });
  useLayoutEffect.useSafeLayoutEffect(() => {
    service.start(hydratedState);
    if (service.state.can("SETUP")) {
      service.send("SETUP");
    }
    return () => {
      service.stop();
    };
  }, []);
  service.setOptions({ actions });
  service.setContext(context);
  return service;
}
function useMachine(machine, options) {
  const service = useService(machine, options);
  const state = useSnapshot.useSnapshot(service.state);
  const typedState = state;
  return [typedState, service.send, service];
}

exports.useMachine = useMachine;
exports.useService = useService;
