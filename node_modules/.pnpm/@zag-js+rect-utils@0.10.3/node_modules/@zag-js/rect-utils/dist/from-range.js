'use strict';

Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });

const rect = require('./rect.js');
const fromElement = require('./from-element.js');
const union = require('./union.js');

function fromRange(range) {
  let rs = [];
  const rects = Array.from(range.getClientRects());
  if (rects.length) {
    rs = rs.concat(rects.map(rect.createRect));
    return union.union.apply(void 0, rs);
  }
  let start = range.startContainer;
  if (start.nodeType === Node.TEXT_NODE) {
    start = start.parentNode;
  }
  if (start instanceof HTMLElement) {
    const r = fromElement.getElementRect(start);
    rs.push({ ...r, x: r.maxX, width: 0 });
  }
  return union.union.apply(void 0, rs);
}

exports.fromRange = fromRange;
